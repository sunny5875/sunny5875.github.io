---
layout: post
title: v0.5.0-íšŒê³ 
date: 2021-01-29 19:20:23 +0900
category: Swift
---
# 0.5.0 ê°œë°œ íšŒê³ 

### DynamicMemberLookUp

state.model.countë¥¼ ë°”ë¡œ state.countë¡œ ê°ˆ ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê²ƒ!!

```swift
@dynamicMemberLookup
struct Child {
	let name: String
	let parent: Parent
	subscript<T>(dynamicMember keyPath: KeyPath<Parent, T>) -> T {
    parent[keyPath: keyPath]
	}
}
```

- CoreDataì—ì„œ codegenì„ í–ˆëŠ”ë° ì´ìƒí•˜ê²Œ ìê¾¸ redefinitionì—ëŸ¬ê°€ ë‚œë‹¤???
    - ë””ë¹„ë§ˆë‹¤ NOneìœ¼ë¡œ ì„¤ì • ë‹¤ í–ˆëŠ”ì§€ ì²´í¬í•  ê²ƒ!

### SecretSharing Entity

![Uniwaffle_v0.5.0_SecretSharingEntityDiagram.drawio.png](0%205%200%20%E1%84%80%E1%85%A2%E1%84%87%E1%85%A1%E1%86%AF%20%E1%84%92%E1%85%AC%E1%84%80%E1%85%A9%203d0e4d8c445845b9bcf7dae6f05f13aa/Uniwaffle_v0.5.0_SecretSharingEntityDiagram.drawio.png)

![ìµœì¢…ë²„ì „: ë‹¤í•©ì¹˜ëŠ”ê²Œ ë” ë‚«ê² ë‹¤ê³  ê²°ì •!~](0%205%200%20%E1%84%80%E1%85%A2%E1%84%87%E1%85%A1%E1%86%AF%20%E1%84%92%E1%85%AC%E1%84%80%E1%85%A9%203d0e4d8c445845b9bcf7dae6f05f13aa/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-11-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.33.29.png)

ìµœì¢…ë²„ì „: ë‹¤í•©ì¹˜ëŠ”ê²Œ ë” ë‚«ê² ë‹¤ê³  ê²°ì •!~

- **usecaseì— ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë“¤ì–´ê°€ë©´ ì•ˆë˜ê³  data moduleì— ìˆì–´ì•¼í•œë‹¤!!**
    - ë„ë©”ì¸ì€ ì„œë²„ë‚˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ìƒíƒœì— ìƒê´€ì—†ì´ ìœ ì§€ë˜ì–´ì•¼ í•˜ê¸° ë•Œë¬¸!!

associationì€ ëŒ€ë“±í•œ ê´€ê³„ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê°œë…!

- composition: í¬í•¨ê´€ê³„, ìƒëª…ì£¼ê¸° ìœ ì‚¬
    - ex) nativeê°€ ì‚¬ë¼ì§€ë©´ tokenë„ ì‚¬ë¼ì§€ë‹ˆê¹Œ compositionì¸ê±°ì§€!
- aggregation: ì¡°ê¸ˆ ì•½í•œ ê²°í•©ê´€ê³„, ë¶€ëª¨ê°€ ì‚­ì œë˜ì–´ë„ ê´€ê³„ì—†ìŒ

### ë””ìì¸ ì‹œìŠ¤í…œ ì ìš©ê¸°

- í°íŠ¸
    - [https://eunjin3786.tistory.com/569](https://eunjin3786.tistory.com/569) ì´ê±¸ ë³´ê³  infoplistë¥¼ ì§ì ‘ ë„£ì–´ì¤˜ì•¼ í•¨
- color
    - [https://tigi44.github.io/ios/iOS,-Swift-Add-Resources-to-a-Swift-Package(Bundling-Resources)/](https://tigi44.github.io/ios/iOS,-Swift-Add-Resources-to-a-Swift-Package(Bundling-Resources)/)ë¡œ ë„£ì–´ì¤˜ì•¼ í•¨
- UIê·¸ë¦¬ë‹¤ê°€ ì´ìƒí•˜ê²Œ ë°±ê·¸ë¼ìš´ë“œë„ ìƒ‰ê¹” ì•ˆë¨¹ê³ â€¦ ë³´ë¼ìƒ‰ì´ ëœ¬ë‹¤ë©´â€¦ ë°”í…€ì„ superviewì— ë§ì¶°ì£¼ìâ€¦
- localization
    - csvë¥¼ íŒŒì‹±í•´ì„œ localized íŒŒì¼ì„ ìƒì„±í•´ì£¼ëŠ” ì½”ë“œê°€ ìˆëŒ•~! ê·¸ëŸ¬ë©´ ì‰½ê²Œ ë°”ë€ë‹¤ê³  í•¨~~~~ íš¨íš¨

---

```jsx
protocol MyDelegate {
    func runDelegateMethod()
}

class ClassProtocolTest: MyDelegate {
    weak var delegate: MyDelegate? // ì—¬ê¸°ì„œ weakë¥¼ ë¶™ì´ëŠ” ì´ìœ ëŠ” retain cycleì„ í”¼í•˜ê¸° ìœ„í•¨
    func runDelegateMethod() {}
}
```

í•˜ì§€ë§Œ, ì—ëŸ¬ê°€ ë°œìƒí•¨!!

<aside>
ğŸ’¡ `'weak' must not be applied to non-class-bound 'MyDelegate'; consider adding a protocol conformance that has a class boun`

</aside>

ìœ„ ë¬¸êµ¬ëŠ” `class`ë¥¼ ë”°ë¥´ì§€ ì•ŠëŠ” í”„ë¡œí† ì½œì„Â `weak`Â ë³€ìˆ˜ë¡œ ì„ ì–¸í•´ ì‚¬ìš©í•  ë•Œ ë°œìƒí•˜ëŠ” ì—ëŸ¬ì„ !

í”„ë¡œí† ì½œì€ í´ë˜ìŠ¤ì™€ êµ¬ì¡°ì²´, ì—´ê±°í˜•ì— ì‚¬ìš© ê°€ëŠ¥í•¨

ì•ì—ì„œ ì„ ì–¸í•œ í”„ë¡œí† ì½œì€ í´ë˜ìŠ¤ì—ì„œ ì‚¬ìš©ë˜ëŠ”ì§€ ì•„ë‹ˆë©´ êµ¬ì¡°ì²´ë‚˜ ì—´ê±°í˜•ì—ì„œ ì‚¬ìš©ë˜ëŠ”ì§€ ì•Œ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì—Â `reference count`ê´€ë¦¬ë¥¼ ìœ„í•´ ì‚¬ìš©ë˜ëŠ”Â `unowned`ì´ë‚˜Â `weak`Â í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ê²ƒì…ë‹ˆë‹¤.

â†’ ë”°ë¼ì„œ í”„ë¡œí† ì½œì´ classë¥¼ ë”°ë¥´ë„ë¡ë§Œ ì œí•œí•´ì£¼ë©´ í•´ê²°!~

```jsx
protocol MyDelegate: class { // ì´ë ‡ê²Œ classë¡œ!!
    func runDelegateMethod()
}
```

---

### CoreDataì˜ race condition

- coredataëŠ” ìƒê°ë³´ë‹¤ thread safeí•˜ì§€ ì•Šë‹¤
- forEachì˜ ê²½ìš° í´ë¡œì €ë¥¼ ë˜ì§„ë‹¤ë¼ëŠ” ê²ƒì„ ìœ ì˜í•´ì•¼ í•¨
- ê·¼ë° forë¬¸ì´ ì•„ë‹Œ forEachë¡œ ì“°ë©´ ì—¬ëŸ¬ ê°œì˜ threadë¡œ ëŒì•„ê°€ê²Œ ë˜ë©´ì„œ ì´ë¡œ ì¸í•´ race conditionì´ ë°œìƒí•´ì„œ ê°€ë” ì•±ì´ ì£½ëŠ” í˜„ìƒì´ ì¼ì–´ë‚¬ì—ˆë”°!!!
- ê·¸ë˜ì„œ ì´ì°¸ì— forë¬¸ìœ¼ë¡œ ëŒë¦¬ê¸°ë„ í•˜ê³  actorë¡œ ë°”ê¾¸ê¸°ë¡œ í–ˆë‹¤

```swift
import UIKit

class Test {
    var num = 0
    
    func increment() async {
        num += 1
        print(num)
    }
}

let a = Test()
let arr = 0...1000

arr.forEach { _ in 
    Task { 
        await a.increment()
    }
}

//for i in arr {
//    Task {
//        await a.increment()
//    }
//}

// ì‹¤í–‰í•˜ë©´ 1234 10 11 12 567... ì´ëŸ°ì”©ìœ¼ë¡œ ì´ì˜ê²Œ ì•ˆì˜¬ë¼ê°„ë‹¤
```

```swift
import UIKit

actor Test {
    var num = 0
    
    func increment() async {
        num += 1
        print(num)
    }
}

let a = Test()
let arr = 0...1000

arr.forEach { _ in 
    Task { 
        await a.increment()
    }
}

//for i in arr {
//    Task {
//        await a.increment()
//    }
//}

// ì´ë ‡ê²Œí•˜ë©´ ì´ì˜ê²Œ ì˜ ì˜¬ë¼ê°!
```

**ê°‘ìê¸° ë¦´ë¦¬ì¦ˆë²„ì „ì„ ì˜¬ë ¸ëŠ”ë° ë¦´ë¦¬ì¦ˆ ë²„ì „ë§Œ ì•±ì´ ì£½ëŠ” í˜„ìƒì´ ì¼ì–´ë‚¬ë‹¤ë©´?**

- optimization levelì„ ë³´ê³  ë³€ê²½í•˜ëŠ” ê²ƒì„ ì¶”ì²œ
- ì´ ë•Œ, apple clang, compiler ê°ê°ì— ëŒ€í•œ optimizationì´ ìˆìœ¼ë¯€ë¡œ ì´ë¥¼ ìœ ì˜í•  ê²ƒ!

### **[Optimization Level](https://developer.apple.com/documentation/xcode/build-settings-reference#Optimization-Level)**

**Setting name:**Â `GCC_OPTIMIZATION_LEVEL`

- **ì´ í™˜ê²½ ë³€ìˆ˜ëŠ” ì£¼ë¡œ C ë° C++ ì½”ë“œ ì»´íŒŒì¼ì— ì‚¬ìš©ë©ë‹ˆë‹¤.**

Specifies the degree to which the generated code is optimized for speed and binary size.

- *None:*Â Do not optimize. [-O0] With this setting, the compilerâ€™s goal is to reduce the cost of compilation and to make debugging produce the expected results. Statements are independentâ€”if you stop the program with a breakpoint between statements, you can then assign a new value to any variable or change the program counter to any other statement in the function and get exactly the results you would expect from the source code.
- *Fast:*Â Optimizing compilation takes somewhat more time, and a lot more memory for a large function. [-O1] With this setting, the compiler tries to reduce code size and execution time, without performing any optimizations that take a great deal of compilation time. In Appleâ€™s compiler, strict aliasing, block reordering, and inter-block scheduling are disabled by default when optimizing.
- *Faster:*Â The compiler performs nearly all supported optimizations that do not involve a space-speed tradeoff. [-O2] With this setting, the compiler does not perform loop unrolling or function inlining, or register renaming. As compared to theÂ `Fast`Â setting, this setting increases both compilation time and the performance of the generated code.
- *Fastest:*Â Turns on all optimizations specified by theÂ `Faster`Â setting and also turns on function inlining and register renaming options. This setting may result in a larger binary. [-O3]
- *Fastest, Smallest:*Â Optimize for size. This setting enables allÂ `Faster`Â optimizations that do not typically increase code size. It also performs further optimizations designed to reduce code size. [-Os]
- *Fastest, Aggressive Optimizations:*Â This setting enablesÂ `Fastest`Â but also enables aggressive optimizations that may break strict standards compliance but should work well on well-behaved code. [-Ofast]
- *Smallest, Aggressive Size Optimizations:*Â This setting enables additional size savings by isolating repetitive code patterns into a compiler generated function. [-Oz]

### **[Optimization Level](https://developer.apple.com/documentation/xcode/build-settings-reference#Optimization-Level)**

**Setting name:**Â `SWIFT_OPTIMIZATION_LEVEL`

- **swift ì»´íŒŒì¼ì— í•„ìš”**
- *None:*Â Compile without any optimization. [-Onone]
- *Optimize for Speed:*Â [-O]
- *Optimize for Size:*Â [-Osize]
- *Whole Module Optimization:*Â [-O -whole-module-optimization]

**â‡’ ì¢€ ë” í…ŒìŠ¤íŠ¸í•´ë³´ë‹ˆê¹Œ ì§„ì§œ coredataìª½ ëª¨ë“ˆë§Œ swift optimization levelì„ .noneìœ¼ë¡œ í•´ì•¼ ë¨â€¦ ì§„ì§œ ë­ì§€ ì½”ì–´ë°ì´í„°? ì§„ì§œ ì–´ì´ì—†ë‹¤â€¦.**

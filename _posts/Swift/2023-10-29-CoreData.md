---
layout: post
title: CoreData
date: 2023-10-29 23:25:33 +0000
category: Swift
---
# CoreData

ì¢…ë¥˜: Develop

[https://github.com/sunny5875/CoreDataStudy.git](https://github.com/sunny5875/CoreDataStudy.git)

### CoreDataë€?

- userDefaultë³´ë‹¤ ì¢€ ë” ë³µì¡í•œ ë°ì´í„°ë¥¼ ì €ì¥í•  ìˆ˜ ìˆëŠ” í”„ë ˆì„ì›Œí¬

### ê¸°ëŠ¥

- persistence
    - ê°ì²´ë¥¼ ì €ì¥ì†Œì— ë§¤í•‘í•˜ëŠ” ì„¸ë¶€ì •ë³´ë¥¼ ì¶”ìƒí™”í•˜ê¸° ë•Œë¬¸ì— DBë¥¼ ê´€ã„¹ë¦¬í•˜ì§€ ì•Šê³ ë„ Swiftë°ì´í„°ë¥¼ ì‰½ê²Œ ì €ì¥í•  ìˆ˜ ìˆìŒ
    
    ![Untitled](CoreData%E1%84%89%E1%85%B3%E1%84%90%E1%85%A5%E1%84%83%E1%85%B5%206d2bcaa51f0d49169790957db08c0c85/Untitled.png)
    
- ê°œë³„/ì¼ê´„ ë³€ê²½ìƒí™©ì„ undo,redoê°€ëŠ¥
    - ë³€ê²½ì‚¬í•­ì„ ì¶”ì í•˜ê³  ê°œë³„ì /ê·¸ë£¹ì ìœ¼ë¡œ í•œë²ˆì— ë¡¤ë°±í•  ìˆ˜ ìˆìŒ
- ë°±ê·¸ë¼ìš´ë“œ ë°ì´í„° ì‘ì—…
    - ë°±ê·¸ë¼ìš´ë“œì—ì„œ jsonì„ ê°ì²´ë¡œ ë¶„ì„í•˜ëŠ” ì‘ì—…ì„ìˆ˜í–‰
- ë™ê¸°í™”
    - DataSourceë¥¼ ì œê³µí•˜ê¸° ë•Œë¬¸ì— ë™ê¸°í™” ìƒíƒœë¡œ ìœ ì§€í•˜ëŠ”ë° ë§ì€ ë„ì›€ì„ ì¤Œ

### íŠ¹ì§•

- Database ì•„ë‹˜!
- cloudKitê³¼ ì—°ë™ì´ ì•„ì£¼ ì‰¬ì›€
    - ë‚´ê°€ ê°€ì§„ ê¸°ê¸°ì—ì„œ ì˜¤ë¸Œì íŠ¸ ì ‘ê·¼ ê°€ëŠ¥
- sqliteë¥¼ ì“°ê¸´ í•˜ì§€ë§Œ ì˜¤ë¸Œì íŠ¸ ê´€ë¦¬ë¥¼ í•´ì¤€ë‹¤ë¼ê³  ìƒê°í•  ê²ƒ
- SQLë„ ì•„ë‹˜
- Containerë¼ëŠ” ê³µê°„ì— ë°ì´í„°ë¥¼ ì €ì¥

### ê°œë…

ì„¸ê°œì˜ ë ˆì´ì–´ ì¡´ì¬

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-10-26 á„‹á…©á„Œá…¥á†« 11.12.21.png](CoreData%E1%84%89%E1%85%B3%E1%84%90%E1%85%A5%E1%84%83%E1%85%B5%206d2bcaa51f0d49169790957db08c0c85/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-26_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_11.12.21.png)

Managed Object model: í´ë˜ìŠ¤, ì´ ëª¨ë¸ì„ í†µí•´ì„œ ì˜¤ë¸Œì íŠ¸ë¥¼ ìƒì„±

Persistent Store Coordinator: ë°ì´í„° ì €ì¥

Managed object model: ì½”ë””ë„¤ì´í„°ì™€ ìŠ¤í† ì–´ë¥¼ ê´€ë¦¬

---

ì—¬ê¸°ì„œ ì ê¹ CoreDataë¥¼ ë§Œë“¤ë ¤ê³  ë³´ë‹ˆ SwiftDataë¼ëŠ” ê°œë…ë„ ë‚˜ì™€ì„œ ì¶”ê°€ ì„¤ëª… ğŸ™‚

### CoreData VS SwiftData

- ê³µí†µì 
    - ë‘˜ë‹¤ object relational mapping frameworkë¡œ dataë¥¼ ì˜êµ¬ì ìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ” ë°©ë²•
- ì°¨ì´ì 
- SwiftData
    - **iOS 17ë¶€í„° ì‚¬ìš© ê°€ëŠ¥**, CoreDataë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ëŠ¥
    - declarative data modeling
    - automatic persistence
    - efficient data access: lazy loadingí•˜ê¸° ë•Œë¬¸ì— ì ‘ê·¼ì´ ì‰¬ì›€
    - integration with SwiftUI
- CoreData
    - mature framework
    - powerful feature
    - well-tested

![Untitled](CoreData%E1%84%89%E1%85%B3%E1%84%90%E1%85%A5%E1%84%83%E1%85%B5%206d2bcaa51f0d49169790957db08c0c85/Untitled%201.png)

<aside>
ğŸ’¡ ì¦‰, SwiftDataëŠ” ìƒˆë¡œ ë‚˜ì˜¨ í”„ë ˆì„ì›Œí¬ì´ê³  ì¢€ ë” ì„ ì–¸ì ì´ê³  ì‚¬ìš©ì„±ì´ ì¢‹ì•„ ë³´ì´ë‚˜ iOS 17 ì†Œë…¸ë§ˆë¶€í„° ì ìš©ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— CoreDataë¥¼ ìš°ì„ ì ìœ¼ë¡œ ì“°ëŠ” ê²ƒì´ ì¢‹ì•„ ë³´ì„!

</aside>

### ì‚¬ìš© ë°©ë²•

1. Data model íŒŒì¼ ì¶”ê°€
2. Entity ìƒì„±
    1. ì—¬ê¸°ì„œ Entityì˜ ì˜ë¯¸
        1. ì €ì¥ë  ë°ì´í„°ë“¤ì˜ ì§‘í•©
3. relation ìƒì„±
    1. propertyë¥¼ ê³„ì‚°í•´ì„œ ë„£ì§€ ì•Šì•„ë„ relationë§Œ ë„£ì–´ì£¼ë©´ ì•„ì˜ˆ ì˜¤ë¸Œì íŠ¸ë¼ë¦¬ relationì´ ìƒì„±ë¨
4. modelì˜ inspectorì—ì„œ codegen ì„ íƒ
- Manual / None(ëª¨ë‘ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤ëŠ” ëœ»)
    - ê´€ë¦¬ ê°ì²´ í•˜ìœ„ í´ë˜ìŠ¤ì˜ í”„ë¡œí¼í‹°, ë…¼ë¦¬ë¥¼ í¸ì§‘
- Class Definition
    - ìƒì„±ëœ ë…¼ë¦¬ë‚˜ í”„ë¡œí¼í‹°ë¥¼ í¸ì§‘í•  í•„ìš”ê°€ ì—†ì„ ê²½ìš° ì„ íƒ
    - ì†ŒìŠ¤ íŒŒì¼ ì—†ì´ ë°”ë¡œ Entity()ê°€ ê°€ëŠ¥í•´ì§„ë‹¤ëŠ” ì†Œë¦¬ì„!!
- Category / Extension
    - ê´€ë¦¬ ê°ì²´ í•˜ìœ„ í´ë˜ìŠ¤ì— ì¶”ê°€ì ì¸ ë©”ì„œë“œë‚˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë…¼ë¦¬ë¥¼ ì¶”ê°€í•˜ê³  ì‹¶ì€ ê²½ìš° ì„ íƒ
1. editorì—ì„œ createNSManagedObjectë¥¼ ì„ íƒ
2. CoreData Stackì„ ì„¤ì •
    1. persistent containerë¥¼ ìƒì„±

![Untitled](CoreData%E1%84%89%E1%85%B3%E1%84%90%E1%85%A5%E1%84%83%E1%85%B5%206d2bcaa51f0d49169790957db08c0c85/Untitled%202.png)

![Untitled](CoreData%E1%84%89%E1%85%B3%E1%84%90%E1%85%A5%E1%84%83%E1%85%B5%206d2bcaa51f0d49169790957db08c0c85/Untitled%203.png)

- NSManagedObjectModel
    - ì•±ì˜ íƒ€ì…, í”„ë¡œí¼í‹°, ê´€ê³„ë¥¼ ì„¤ëª…í•˜ëŠ” ì•±ì˜ ëª¨ë¸ íŒŒì¼
        - Entityë¥¼ ì„¤ëª…í•˜ëŠ” databaseì˜ ìŠ¤í‚¤ë§ˆ
- NSManagedObjectContext
    - ì•± íƒ€ì…ì˜ ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•œ ë³€ê²½ ì‚¬í•­ì„ ì¶”ì 
    - objectë¥¼ ìƒì„±, ì €ì¥, ê°€ì ¸ì˜¤ëŠ” ì‘ì—…ì„ ì œê³µ
- NSPersistentStoreCoordinator
    - ìŠ¤í† ì–´ì—ì„œ ì•± íƒ€ì…ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì €ì¥í•˜ê³  ê°€ì ¸ì˜´
    - ì˜êµ¬ ì €ì¥ì†Œì™€ managedObjectModelì„ ì—°ê²°
- NSPersistentContainer
    - ëª¨ë¸, ì»¨í…ìŠ¤íŠ¸, ìŠ¤í† ì–´ coordinatorë¥¼ í•œ ë²ˆì— ì„¤ì •
    - ëª¨ë“  ê°ì²´ë¥¼ í¬í•¨í•˜ëŠ” ìµœìƒìœ„ ì¹­êµ¬

### container

- ì´ê³³ì˜ ë°ì´í„°ëŠ” ëª¨ë‘ ê³µìœ ëœ ìì›ì„ ì‚¬ìš©í•˜ê¸°ì— ì‹±ê¸€í†¤ìœ¼ë¡œ ìƒì„±

```swift
class CoreDataDB {
    
    static let shared = CoreDataDB()
    
    // ì—¬ê¸° ì´ë¦„ì€ ëª¨ë¸ ì´ë¦„ì„ ë„£ì„ ê²ƒ
    private let container = NSPersistentContainer(name: "Model")
    var context: NSManagedObjectContext {
        container.viewContext
    }
    
    private init() {
        loadStores()
    }
    
    private func loadStores() {
        container.loadPersistentStores(completionHandler: { _, _ in })
    }
    
    func save() {
        try? context.save()
    }
}
```

### CoreData Stack

- ì•±ì˜ ëª¨ë¸ ë ˆì´ì–´ë¥¼ ê´€ë¦¬í•˜ê³  ìœ ì§€í•˜ëŠ” ì—­í• 

### ì €ì¥í•˜ëŠ” ë°©ë²•

1. NSManagedObjectContextë¥¼ ê°€ì ¸ì˜¨ë‹¤
2. Entityë¥¼ ê°€ì ¸ì˜¨ë‹¤
3. NSManagedObjectë¥¼ ë§Œë“ ë‹¤
4. NSManagedObjectì— ê°’ì„ ì„¸íŒ…í•œë‹¤
5. NSManagedObjectContextë¥¼ ì €ì¥í•œë‹¤.

### Optionalì´ë‚˜ defaultê°’ ì„¤ì •í•˜ëŠ” ë°©ë²•

attributeì˜ inspectorë¥¼ ë³´ë©´ ë³´ì¸ë‹¤!!

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-10-26 á„‹á…©á„’á…® 2.25.09.png](CoreData%E1%84%89%E1%85%B3%E1%84%90%E1%85%A5%E1%84%83%E1%85%B5%206d2bcaa51f0d49169790957db08c0c85/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-26_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.25.09.png)

### GUIë¼ê³  í•´ì„œ ë§Œë§Œí•˜ê²Œ ë³´ì§€ ë§ìŸˆâ€¦

- ë””ë¹„ì— ê°’ì´ ìˆëŠ”ë° GUIì— ì†ëŒ”ë‹¤?? ê·¸ëŸ¬ë©´ migrationí•´ì¤˜ì•¼í•œë‹¤â€¦;;
- add model version í›„ì— ë°”ê¿€ ê±° ë°”ê¾¸ê³  ê¸°ë³¸ ëª¨ë¸ ì„¤ì •ë°”ê¾¸ê³  ë§µí•‘ ëª¨ë¸ ë§Œë“¤ë©´ ì„±ê³µ~
- [https://yeonduing.tistory.com/48](https://yeonduing.tistory.com/48) ì°¸ê³ 

### Unique ì œì•½ì¡°ê±´ ë‘ëŠ” ë°©ë²•

- inspectorì— ë³´ë©´ constaintê°€ ìˆìŒ ê±°ê¸°ì— uniqueë¥¼ ë‘ê³  ì‹¶ì€ propertyê°’ì„ ì ìœ¼ë©´ ë¨

### Upsertì§€ì›í•˜ëŠ” ë°©ë²•

- ì¼ë‹¨ unique keyë¥¼ ìƒì„±í•˜ê³ 
- createí•˜ëŠ” ë¶€ë¶„ì—  mergepolicy ì§€ì •í•˜ë©´ ë¨

```swift
func create(_ item: MemoEntity) {
        let new = Memo(context: db.context) // contextë¥¼ ê°€ì ¸ì™€ì„œ NSManagedObjectë¥¼ ë§Œë“ ë‹¤
        new.date = item.date
        new.context = item.context
        new.title = item.title
        new.id = item.id
        db.context.mergePolicy = NSMergePolicy.mergeByPropertyObjectTrump // upsertë¥¼ ì§€ì›í•˜ê¸° ìœ„í•¨
        db.save() // NSManagedObjectContextë¥¼ ì €ì¥
    }
```

### AutoIncrement

- ì°¾ì•„ë³¸ ê²°ê³¼ë¡œëŠ” ì§€ì›í•˜ì§€ ì•ŠëŠ” ê²ƒìœ¼ë¡œ ë³´ì„
- í•˜ì§€ë§Œ ë‚´ë¶€ì˜ objectIdê°€ ìˆì–´ ëŒ€ì²´í•  ìˆ˜ ìˆì„ ê²ƒìœ¼ë¡œ ë³´ì„

### ë””ë¹„ ì´ë¦„ ë°”ê¿€ ë•Œ ìœ ì˜ ì 

- ë‹¨ìˆœíˆ classì´ë¦„ë§Œ renameí•  ê²Œ ì•„ë‹ˆë¼ db fetchí•  ë•Œì˜ ë¬¸ìì—´ë„ ë°”ê¿”ì¤˜ì•¼ í•˜ê³  objc ë’¤ì— ìˆëŠ” ì´ë¦„ë„ ë°”ê¿”ì¤˜ì•¼ í•¨!

---

### CoreData Tutorial

ì „ì²´ íë¦„: ë©”ëª¨ë¥¼ ë³¼ ìˆ˜ ìˆê³  ë©”ëª¨ë¥¼ ì¶”ê°€ ë° ìœ ì €ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

1. CoreDataModel íŒŒì¼ ìƒì„±
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-10-31 á„‹á…©á„’á…® 1.46.16.png](CoreData%E1%84%89%E1%85%B3%E1%84%90%E1%85%A5%E1%84%83%E1%85%B5%206d2bcaa51f0d49169790957db08c0c85/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-31_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_1.46.16.png)
    
2. Entityë¥¼ ìƒì„±
    1. attribute: ì†ì„±ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.(inspectorë¥¼ ë³´ë©´ ì¶”ê°€ì ì¸ ë‹¤ì–‘í•œ optional, default ë“±ë“± ì„ íƒ ê°€ëŠ¥)
    2. relationship: ì—”í‹°í‹°ë¼ë¦¬ì˜ ê´€ê³„ë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.(inspectorë¥¼ í†µí•´ 1:1, 1:M ê´€ê³„ ì§€ì • ê°€ëŠ¥)
    3. fetched property: ì•½í•œ ë‹¨ë°©í–¥ ê´€ê³„, ë‹¤ë¥¸ ë°ì´í„° ê°ì²´ì—ì„œ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ë°ì´í„° ê°ì²´ì˜ ì†ì„±ì„ í—ˆìš©

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-10-31 á„‹á…©á„’á…® 1.46.48.png](CoreData%E1%84%89%E1%85%B3%E1%84%90%E1%85%A5%E1%84%83%E1%85%B5%206d2bcaa51f0d49169790957db08c0c85/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-31_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_1.46.48.png)

1. Codegenìœ¼ë¡œ entity class ìë™ìƒì„±
    1. ì†ì„±ê³¼ classë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•˜ì§€ ì•Šê³  ëª¨ë‘ ìˆ˜ì • í•„ìš”í•œ ê²½ìš° manual/noneìœ¼ë¡œ ì„ íƒ

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-10-31 á„‹á…©á„’á…® 1.50.34.png](CoreData%E1%84%89%E1%85%B3%E1%84%90%E1%85%A5%E1%84%83%E1%85%B5%206d2bcaa51f0d49169790957db08c0c85/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-31_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_1.50.34.png)

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-10-31 á„‹á…©á„’á…® 1.52.04.png](CoreData%E1%84%89%E1%85%B3%E1%84%90%E1%85%A5%E1%84%83%E1%85%B5%206d2bcaa51f0d49169790957db08c0c85/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-31_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_1.52.04.png)

<aside>
ğŸ’¡ ì´ ë•Œ, ëª¨ë“  ì—”í‹°í‹°ê°€ ë‹¤ manual/noneì´ì–´ì•¼ í•œë‹¤!! í•˜ë‚˜ë¼ë„ ì•„ë‹ˆë©´ ì—ëŸ¬ë‚˜ë‹ˆê¹Œ ì¡°ì‹¬í•  ê²ƒ

</aside>

![class](CoreData%E1%84%89%E1%85%B3%E1%84%90%E1%85%A5%E1%84%83%E1%85%B5%206d2bcaa51f0d49169790957db08c0c85/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-31_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_1.55.30.png)

class

![property](CoreData%E1%84%89%E1%85%B3%E1%84%90%E1%85%A5%E1%84%83%E1%85%B5%206d2bcaa51f0d49169790957db08c0c85/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-31_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_1.55.41.png)

property

1. Container ìƒì„±
    1. í”„ë¡œì íŠ¸ ë§Œë“¤ì—ˆì„ ë•Œ CoreDataë¥¼ includeí–ˆë‹¤ë©´ appdelegateì— ê´€ë ¨ ì½”ë“œê°€ ì´ë¯¸ ìˆì„ ê²ƒì´ê³  ì•„ë‹ˆë¼ë©´ ì•„ë˜ì™€ ê°™ì´ ìƒˆë¡œ ìƒì„±í•˜ë©´ ë¨
    2. dbì´ê¸° ë•Œë¬¸ì— ì‹±ê¸€í†¤ìœ¼ë¡œ ë§Œë“œëŠ” ê²½ìš°ê°€ ë§ì€ í¸
    
    ```swift
    import CoreData
    
    /// 1. Container ìƒì„±
    class CoreDataDB {
        
        static let shared = CoreDataDB()
        
        // ì—¬ê¸° ì´ë¦„ì€ ëª¨ë¸ ì´ë¦„ì„ ë„£ì„ ê²ƒ
        private let container = NSPersistentContainer(name: "Model")
        
        // context
        var context: NSManagedObjectContext {
            return container.viewContext
        }
        
        private init() {
            loadStores()
        }
        // store
        private func loadStores() {
            container.loadPersistentStores(completionHandler: { _, _ in })
        }
        
        func save() {
            do {
              try context.save()
              } catch {
              let nserror = error as NSError
              NSLog("Unresolved error \(nserror), \(nserror.userInfo)")
              }
        }
    }
    ```
    
2. Repository ë° entity ìƒì„±
    1. ì—¬ê¸°ì„œì˜ entityëŠ” view, viewModelì—ì„œ ì‚¬ìš©í•˜ëŠ” entityë¥¼ ì˜ë¯¸

```swift
struct UserEntity: SelfReturnable, Hashable {
    var name: String
    var nickname: String
    var isGirl: Bool = false
}
```

```swift
import Foundation
import CoreData

final class UserRepository {
    
    private let db = CoreDataDB.shared
    
    private func getAll() -> [User] {
        let request: NSFetchRequest<User> = User.fetchRequest()
        let result = try? db.context.fetch(request)
        return result ?? []
    }
    
    private func getItem<T: Equatable>(_ keyPath: WritableKeyPath<User, T>, _ value: T) -> User? {
        getAll().filter { $0[keyPath: keyPath] == value }.first
    }
}

extension UserRepository: ItemRepositoriable {
    typealias Entity = UserEntity
    func create(_ item: UserEntity) {
        let new = User(context: db.context) // contextë¥¼ ê°€ì ¸ì™€ì„œ NSManagedObjectë¥¼ ë§Œë“ ë‹¤
        new.name = item.name
        new.nickname = item.nickname
        new.isGirl = item.isGirl
        db.context.mergePolicy = NSMergePolicy.mergeByPropertyObjectTrump // upsertë¥¼ ì§€ì›í•˜ê¸° ìœ„í•¨
        db.save() // NSManagedObjectContextë¥¼ ì €ì¥
    }
    
    
    /*
     - Entity ì§€ì • (FROM): í•„ìˆ˜ - NSFetchRequest
     - ê²€ìƒ‰ ì¡°ê±´ ì§€ì • (WHERE): ìƒëµ ê°€ëŠ¥ - NSPredicate
     - ì •ë ¬ ì¡°ê±´ ì§€ì • (ORDER BY): ìƒëµ ê°€ëŠ¥ - NSSortDescriptor
     */
    func edit(_ item: UserEntity) {
        let request: NSFetchRequest<User> = User.fetchRequest()
        request.predicate = NSPredicate(format: "name == %@", item.name)
        let object = try? db.context.fetch(request).first
        object?.name = item.name
        object?.nickname = item.nickname
        object?.isGirl = item.isGirl
        db.save()
    }
    
    func getItem<T: Equatable>(_ keyPath: WritableKeyPath<UserEntity, T>, _ value: T) -> UserEntity? {
        self.getAllItems().filter { $0[keyPath: keyPath] == value }.first
    }
    
    func getAllItems() -> [UserEntity] {
        let request: NSFetchRequest<User> = User.fetchRequest()
        let result = try? db.context.fetch(request).map { $0.toEntity }
        
        return result ?? []
    }
    
    func delete(_ item: UserEntity) {
        let object: User? = self.getItem(\.name, item.name)
        guard let object else { return }
        db.context.delete(object)
        db.save()
    }
    
}
```

<aside>
ğŸ’¡ ë‚˜ì¤‘ì— ë°ì´í„°ë² ì´ìŠ¤ì˜ ì´ë¦„ì„ ë°”ê¿€ ê²½ìš°, renameë¿ë§Œ ì•„ë‹ˆë¼ @objc(ëª¨ë¸ì´ë¦„)ê³¼ â€œëª¨ë¸ì´ë¦„â€ë„ ë‹¤ ë°”ê¿”ì¤˜ì•¼ í•¨

</aside>

1. ë§Œì•½ ëª¨ë¸ì— ëŒ€í•œ ì²˜ë¦¬ê°€ ë” í•„ìš”í•´ì„œ ë§ˆì´ê·¸ë ˆì´ì…˜ì„ í•´ì•¼í•˜ëŠ” ê²½ìš°
    1. Editor â†’ add Model versionìœ¼ë¡œ ëª¨ë¸ ì¶”ê°€
        
        ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-10-31 á„‹á…©á„’á…® 3.51.15.png](CoreData%E1%84%89%E1%85%B3%E1%84%90%E1%85%A5%E1%84%83%E1%85%B5%206d2bcaa51f0d49169790957db08c0c85/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-31_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.51.15.png)
        
    2. í•„ìš”í•œ ìˆ˜ì • ì§„í–‰
    3. ê¸°ë³¸ ëª¨ë¸ì„ ìƒˆë¡œìš´ ëª¨ë¸ë¡œ ë³€ê²½(ë°”ê¾¼ ê²½ìš° í•´ë‹¹ ëª¨ë¸ì— ì´ˆë¡ìƒ‰ checkê°€ file êµ¬ì¡°ì— ë³´ì„)
        
        ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-10-31 á„‹á…©á„’á…® 3.51.30.png](CoreData%E1%84%89%E1%85%B3%E1%84%90%E1%85%A5%E1%84%83%E1%85%B5%206d2bcaa51f0d49169790957db08c0c85/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-31_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.51.30.png)
        
    4. mapping model ìƒì„±
        
        ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-10-31 á„‹á…©á„’á…® 3.52.54.png](CoreData%E1%84%89%E1%85%B3%E1%84%90%E1%85%A5%E1%84%83%E1%85%B5%206d2bcaa51f0d49169790957db08c0c85/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-31_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.52.54.png)
